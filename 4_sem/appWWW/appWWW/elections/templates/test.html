{% extends 'base.html' %}

{% block content %}

{% if data is defined %}

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type='text/javascript' src='https://www.google.com/jsapi'></script>
<script type='text/javascript'>
google.load('visualization', '1', {'packages': ['geochart']});
google.charts.load('current', {'packages':['corechart']});

google.setOnLoadCallback(drawMarkersMap);
//google.charts.setOnLoadCallback(drawChart);

function drawMarkersMap() {
    var jsonData = `{{ data }}`

    var data = new google.visualization.DataTable(jsonData);

    var options = {
        region: 'PL',
        dataMode: 'regions',
        displayMode: 'regions',
        resolution: 'provinces',
        legend: 'none',
        enableRegionInteractivity: 'true',
        sizeAxis: {minSize:5,  maxSize: 5},
        colorAxis: {colors: ['#0B2762']}
    };

    var chart = new google.visualization.GeoChart(document.getElementById('map_chart'));
    chart.draw(data, options);
};


function drawChart() {

    var data = new google.visualization.DataTable(jsonData);

    var options = {
        title: 'Głosy'
    };

    var chart = new google.visualization.PieChart(document.getElementById('piechart'));

    chart.draw(data, options);
};

</script>

{% endif%}

<div id="charts">

    {% if data is defined %}
    <div id="map_chart"></div>
    {% endif %}

    <div class="chart">
        {% for stat in candidates_stats %}
        <div class="bar_wrap">
            <div class="bar" style="height: {{ stat[2] }}%;">
                <div>
                    {{ "%.2f" % stat[1] | float }}%
                </div>
            </div>
            <div class="legend">
                {{ stat[0] }}
            </div>
        </div>
        {% endfor %}
    </div>

</div>

<table>
    <tr>
        <th>
            Województwo
        </th>
        <th>
            Uprawnionych
        </th>
        <th>
            Kart ważnych
        </th>
        <th>
            Frekwencja
        </th>
    </tr>
    {% for w in regions %}
    <tr>
        <td>
            {{ w.name }}
        </td>
        <td>
            {{ w.voters }}
        </td>
        <td>
            {{ w.ballots }}
        </td>
        <td>
            {{ "%.2f" % (w.ballots / w.voters * 100) | float }}%
        </td>
    </tr>
    {% endfor %}

</table>
<div>
asdofajsdofjaoisdfjoaisdjfa
sdfaoisdjfoaij
</div>

{% endblock %}
